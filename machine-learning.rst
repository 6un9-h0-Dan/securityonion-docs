.. _machine-learning:

Machine Learning
================

As part of a push to introduce machine learning to Security Onion, we have recently added a new tool (currently in beta) called logscan which utilizes machine learning models to detect anomalies in logs generated by Security Onion components. 

.. note::
    This tool, and any future ML components, have dependencies that require special consideration to be made in regards to hardware or VM configurations prior to installation. 
    Namely, a CPU/vCPU with AVX support is required, with AVX2 support recommended for better performance.

Listing components
------------------
To list all available ML components:

::

    sudo so-learn list

.. note::
    Currently logscan is the only ML component available.


Enabling components
-------------------
To enable an ML component:

::

    sudo so-learn enable <component> # --apply to immediately apply your changes


Disabling components
--------------------
To disable an ML component:

::

    sudo so-learn disable <component> # --apply to immediately apply your changes


Logscan
-------------------
Uses the following models to predict on Security Onion Console login activity

    K1: Alerts on a high number of logins from a single IP in a 1 minute window

    K5: Alerts on a high ratio of login failures from a single IP in a 5 minute window

    K60: Alerts on abnormal patterns of login failures from all IPs in a 1 hour window
